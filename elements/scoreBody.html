<link rel="import" href="../app/components/polymer/polymer.html" />
<link rel="import" href="../app/components/polymer-ajax/polymer-ajax.html" />
<link rel="import" href="../app/components/polymer-localstorage/polymer-localstorage.html">
<link rel="import" href="scoreHeader.html" />
<link rel="import" href="scoreCanvas.html" />
<polymer-element name="smw-scoreBody">
    <template>
        <style>
            :host {
                border: solid 1px #EEE;
                display: block;
                height: 1100px;
                margin: 10px;
                padding: 20px;
                width: 850px;
            }
            :host(.landscape) {
                height: 850px;
                width: 1100px;
            }
        </style>
        <polymer-ajax auto url="/testData/testScore.json"
            handleAs="json"
            on-polymer-response="{{scoreReceived}}">
        </polymer-ajax>
        <polymer-localstorage id="scoreStorage" name="SMWScoreData" value="{{scoreData}}"></polymer-localstorage>
        <smw-scoreHeader id="scoreHeader" data="{{scoreData}}"></smw-scoreHeader>
        <smw-scoreCanvas id="scoreCanvas" data="{{scoreData.music}}"></smw-scoreCanvas>
    </template>
    <script>
        (function() {
            'use strict';
            Polymer('smw-scoreBody', {
                ready: function() {
                    this.scoreData = this.scoreData || {};
                },
                scoreReceived: function(e) {
                    this.scoreData = e.detail.response || {};
                },
                scoreDataChanged: function() {
                    console.log('scoreData changed');
                    //this.$.scoreStorage.value = this.scoreData;
                    //this.$.scoreStorage.save();
                }
            });
        })();
    </script>
</polymer-element>
